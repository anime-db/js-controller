/* js-controller 2016-04-20 */
function extend(Child,Parent){var F=function(){};F.prototype=Parent.prototype,Child.prototype=new F,Child.prototype.constructor=Child,Child.superclass=Parent.prototype}var Controller=function(){this._controls=[]};Controller.prototype.addControl=function(name,control){control instanceof ControllerControl&&(control.setController(this),this._controls[name]=control)},Controller.prototype.bindControl=function(target){var name=target.data("control");this._controls[name]instanceof ControllerControl&&this._controls[name].bind(target)},Controller.prototype.bind=function(target){if(target=$(target||"body"),target.data("control"))this.bindControl(target);else{var that=this;target.find("[data-control]").each(function(){that.bindControl($(this))})}};var ControllerControl=function(){};ControllerControl.prototype.setController=function(controller){},ControllerControl.prototype.bind=function(target){throw new Error("Must be implemented")};var FormToken=function(){this._token="",this._url="",this._wait=!1};FormToken.prototype.getToken=function(){return this._token},FormToken.prototype.setUrl=function(url){this._url=url,url&&!this._token&&this.refreshToken()},FormToken.prototype.refreshToken=function(callback){if(!this._wait&&this._url){this._wait=!0;var that=this;$.ajax({url:this._url,type:"POST",dataType:"text",processData:!1,contentType:!1,success:function(response){that._token=response,that._wait=!1,(callback||function(){})()},complete:function(){that._wait=!1}})}};var Locker=function(){this._is_lock=!1,this._body=$("body")};Locker.prototype.lock=function(el){this._is_lock=!0,this._body.addClass("locker_wait"),el&&el.addClass("locker_lock")},Locker.prototype.unlock=function(el){this._is_lock=!1,this._body.removeClass("locker_wait"),el&&el.removeClass("locker_lock")},Locker.prototype.isLock=function(){return this._is_lock};